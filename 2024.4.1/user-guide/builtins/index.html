
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../workers/">
      
      
        <link rel="next" href="../ffi/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.0, mkdocs-material-9.3.1">
    
    
      
        <title>Builtin helpers - PyScript</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.046329b4.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.85d0ee34.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="orange" data-md-color-accent="indigo">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#builtin-helpers" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
          <aside class="md-banner md-banner--warning">
            <div class="md-banner__inner md-grid md-typeset">

  You're not viewing the latest version.
  <a href="../">
    <strong>Click here to go to latest.</strong>
  </a>

            </div>
            <script>var el=document.querySelector("[data-md-component=outdated]"),outdated=__md_get("__outdated",sessionStorage);!0===outdated&&el&&(el.hidden=!1)</script>
          </aside>

      </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="PyScript" class="md-header__button md-logo" aria-label="PyScript" data-md-component="logo">
      
  <img src="../../assets/images/pyscript-black.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            PyScript
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Builtin helpers
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="orange" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_3" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9h-1.9M20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69m-9.15 3.96h2.3L12 9l-1.15 3.65Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="orange" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="orange" data-md-color-accent="indigo"  aria-label="Switch to system preference"  type="radio" name="__palette" id="__palette_3">
    
      <label class="md-header__button md-icon" title="Switch to system preference" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
</form>
      
    
    
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="PyScript" class="md-nav__button md-logo" aria-label="PyScript" data-md-component="logo">
      
  <img src="../../assets/images/pyscript-black.svg" alt="logo">

    </a>
    PyScript
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../../beginning-pyscript/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Beginning PyScript
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../../conduct/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Code of Conduct
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../../contributing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Contributing
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Developer Guide
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../../license/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    License
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" checked>
        
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    User guide
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            User guide
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../what/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    What is PyScript?
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../features/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Features
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../first-steps/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    First steps
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../architecture/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Architecture
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../configuration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Configuration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../dom/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    The DOM &amp; JavaScript
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../workers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Workers
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Builtin helpers
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Builtin helpers
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#common-features" class="md-nav__link">
    Common features
  </a>
  
    <nav class="md-nav" aria-label="Common features">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pyscriptwindow" class="md-nav__link">
    pyscript.window
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyscriptdocument" class="md-nav__link">
    pyscript.document
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyscriptdisplay" class="md-nav__link">
    pyscript.display
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyscriptwhen" class="md-nav__link">
    pyscript.when
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyscriptjs_modules" class="md-nav__link">
    pyscript.js_modules
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyscriptfetch" class="md-nav__link">
    pyscript.fetch
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyscriptffito_js" class="md-nav__link">
    pyscript.ffi.to_js
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyscriptfficreate_proxy" class="md-nav__link">
    pyscript.ffi.create_proxy
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyscriptcurrent_target" class="md-nav__link">
    pyscript.current_target
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyscripthtml" class="md-nav__link">
    pyscript.HTML
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyscriptrunning_in_worker" class="md-nav__link">
    pyscript.RUNNING_IN_WORKER
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#main-thread-only-features" class="md-nav__link">
    Main-thread only features
  </a>
  
    <nav class="md-nav" aria-label="Main-thread only features">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pyscriptpyworker" class="md-nav__link">
    pyscript.PyWorker
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#worker-only-features" class="md-nav__link">
    Worker only features
  </a>
  
    <nav class="md-nav" aria-label="Worker only features">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pyscriptsync" class="md-nav__link">
    pyscript.sync
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#html-attributes" class="md-nav__link">
    HTML attributes
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../ffi/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    FFI in detail
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../terminal/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Python terminal
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../editor/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Python editor
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../plugins/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Plugins
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../offline/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Use Offline
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../examples/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Example apps
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../faq/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    F.A.Q.
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#common-features" class="md-nav__link">
    Common features
  </a>
  
    <nav class="md-nav" aria-label="Common features">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pyscriptwindow" class="md-nav__link">
    pyscript.window
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyscriptdocument" class="md-nav__link">
    pyscript.document
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyscriptdisplay" class="md-nav__link">
    pyscript.display
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyscriptwhen" class="md-nav__link">
    pyscript.when
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyscriptjs_modules" class="md-nav__link">
    pyscript.js_modules
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyscriptfetch" class="md-nav__link">
    pyscript.fetch
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyscriptffito_js" class="md-nav__link">
    pyscript.ffi.to_js
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyscriptfficreate_proxy" class="md-nav__link">
    pyscript.ffi.create_proxy
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyscriptcurrent_target" class="md-nav__link">
    pyscript.current_target
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyscripthtml" class="md-nav__link">
    pyscript.HTML
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyscriptrunning_in_worker" class="md-nav__link">
    pyscript.RUNNING_IN_WORKER
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#main-thread-only-features" class="md-nav__link">
    Main-thread only features
  </a>
  
    <nav class="md-nav" aria-label="Main-thread only features">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pyscriptpyworker" class="md-nav__link">
    pyscript.PyWorker
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#worker-only-features" class="md-nav__link">
    Worker only features
  </a>
  
    <nav class="md-nav" aria-label="Worker only features">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pyscriptsync" class="md-nav__link">
    pyscript.sync
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#html-attributes" class="md-nav__link">
    HTML attributes
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="builtin-helpers">Builtin helpers</h1>
<p>PyScript makes available convenience objects and functions inside
Python as well as custom attributes in HTML.</p>
<p>In Python this is done via the <code>pyscript</code> module:</p>
<div class="language-python highlight"><span class="filename">Accessing the document object via the pyscript module</span><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">from</span> <span class="nn">pyscript</span> <span class="kn">import</span> <span class="n">document</span>
</span></code></pre></div>
<p>In HTML this is done via <code>py-*</code> attributes:</p>
<div class="language-html highlight"><span class="filename">An example of a py-click handler</span><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="p">&lt;</span><span class="nt">button</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;foo&quot;</span> <span class="na">py-click</span><span class="o">=</span><span class="s">&quot;handler_defined_in_python&quot;</span><span class="p">&gt;</span>Click me<span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
</span></code></pre></div>
<h2 id="common-features">Common features</h2>
<p>These Python objects / functions are available in both the main thread and in
code running on a web worker:</p>
<h3 id="pyscriptwindow"><code>pyscript.window</code></h3>
<p>On the main thread, this object is a direct reference to the <code>import js</code> module which, in turn, is a proxy of the <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/globalThis">globalThis</a>.</p>
<p>On a worker thread, this object is a proxy for the web page's
<a href="https://developer.mozilla.org/en-US/docs/Web/API/Window">global window context</a>.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Please note that in workers, this is still the main window, not the
worker's own global context. A worker's global context is always reachable
instead via <code>import js</code> (the <code>js</code> object being a proxy for the worker's
<code>globalThis</code>).</p>
</div>
<h3 id="pyscriptdocument"><code>pyscript.document</code></h3>
<p>On both main and worker threads, this object is a proxy for the the web page's
<a href="https://developer.mozilla.org/en-US/docs/Web/API/Document">document object</a>.
The <code>document</code> is a representation of the
<a href="https://developer.mozilla.org/en-US/docs/Web/API/Document_object_model/Using_the_Document_Object_Model">DOM</a>
and can be used to read or manipulate the content of the web page.</p>
<h3 id="pyscriptdisplay"><code>pyscript.display</code></h3>
<p>A function used to display content. The function is intelligent enough to
introspect the object[s] it is passed and work out how to correctly display the
object[s] in the web page.</p>
<p>The <code>display</code> function takes a list of <code>*values</code> as its first argument, and has
two optional named arguments:</p>
<ul>
<li><code>target=None</code> - the DOM element into which the content should be placed.
  If not specified, the <code>target</code> will use the <code>current_script()</code> returned id
  and populate the related dedicated node to show the content.</li>
<li><code>append=True</code> - a flag to indicate if the output is going to be appended to
  the <code>target</code>.</li>
</ul>
<p>There are some caveats:</p>
<ul>
<li>When used in the main thread, the <code>display</code> function automatically uses
  the current <code>&lt;py-script&gt;</code> or <code>&lt;mpy-script&gt;</code> tag as the <code>target</code> into which
  the content will be displayed.</li>
<li>If the <code>&lt;script&gt;</code> tag has the <code>target</code> attribute, and is not a worker,
  the element on the page with that ID (or which matches that selector)
  will be used to display the content instead.</li>
<li>When used in a worker, the <code>display</code> function needs an explicit
  <code>target="dom-id"</code> argument to identify where the content will be
  displayed.</li>
<li>In both the main thread and worker, <code>append=True</code> is the default
  behaviour.</li>
</ul>
<div class="language-html highlight"><span class="filename">Some display example</span><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="cm">&lt;!-- will produce</span>
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="cm">    &lt;py-script&gt;PyScript&lt;/py-script&gt;</span>
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a><span class="cm">--&gt;</span>
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a><span class="p">&lt;</span><span class="nt">py-script</span> <span class="na">worker</span><span class="p">&gt;</span>
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a>    from pyscript import display
</span><span id="__span-2-6"><a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a>    display(&quot;PyScript&quot;, append=False)
</span><span id="__span-2-7"><a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a><span class="p">&lt;/</span><span class="nt">py-script</span><span class="p">&gt;</span>
</span><span id="__span-2-8"><a id="__codelineno-2-8" name="__codelineno-2-8" href="#__codelineno-2-8"></a>
</span><span id="__span-2-9"><a id="__codelineno-2-9" name="__codelineno-2-9" href="#__codelineno-2-9"></a><span class="cm">&lt;!-- will produce</span>
</span><span id="__span-2-10"><a id="__codelineno-2-10" name="__codelineno-2-10" href="#__codelineno-2-10"></a><span class="cm">    &lt;script type=&quot;py&quot;&gt;...&lt;/script&gt;</span>
</span><span id="__span-2-11"><a id="__codelineno-2-11" name="__codelineno-2-11" href="#__codelineno-2-11"></a><span class="cm">    &lt;script-py&gt;PyScript&lt;/script-py&gt;</span>
</span><span id="__span-2-12"><a id="__codelineno-2-12" name="__codelineno-2-12" href="#__codelineno-2-12"></a><span class="cm">--&gt;</span>
</span><span id="__span-2-13"><a id="__codelineno-2-13" name="__codelineno-2-13" href="#__codelineno-2-13"></a><span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;py&quot;</span><span class="p">&gt;</span>
</span><span id="__span-2-14"><a id="__codelineno-2-14" name="__codelineno-2-14" href="#__codelineno-2-14"></a><span class="w">    </span><span class="kr">from</span><span class="w"> </span><span class="nx">pyscript</span><span class="w"> </span><span class="k">import</span><span class="w"> </span><span class="nx">display</span>
</span><span id="__span-2-15"><a id="__codelineno-2-15" name="__codelineno-2-15" href="#__codelineno-2-15"></a><span class="w">    </span><span class="nx">display</span><span class="p">(</span><span class="s2">&quot;PyScript&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">append</span><span class="o">=</span><span class="nx">False</span><span class="p">)</span>
</span><span id="__span-2-16"><a id="__codelineno-2-16" name="__codelineno-2-16" href="#__codelineno-2-16"></a><span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</span><span id="__span-2-17"><a id="__codelineno-2-17" name="__codelineno-2-17" href="#__codelineno-2-17"></a>
</span><span id="__span-2-18"><a id="__codelineno-2-18" name="__codelineno-2-18" href="#__codelineno-2-18"></a><span class="cm">&lt;!-- will populate &lt;h1&gt;PyScript&lt;/h1&gt; --&gt;</span>
</span><span id="__span-2-19"><a id="__codelineno-2-19" name="__codelineno-2-19" href="#__codelineno-2-19"></a><span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;py&quot;</span> <span class="na">target</span><span class="o">=</span><span class="s">&quot;my-h1&quot;</span><span class="p">&gt;</span>
</span><span id="__span-2-20"><a id="__codelineno-2-20" name="__codelineno-2-20" href="#__codelineno-2-20"></a><span class="w">    </span><span class="kr">from</span><span class="w"> </span><span class="nx">pyscript</span><span class="w"> </span><span class="k">import</span><span class="w"> </span><span class="nx">display</span>
</span><span id="__span-2-21"><a id="__codelineno-2-21" name="__codelineno-2-21" href="#__codelineno-2-21"></a><span class="w">    </span><span class="nx">display</span><span class="p">(</span><span class="s2">&quot;PyScript&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">append</span><span class="o">=</span><span class="nx">False</span><span class="p">)</span>
</span><span id="__span-2-22"><a id="__codelineno-2-22" name="__codelineno-2-22" href="#__codelineno-2-22"></a><span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</span><span id="__span-2-23"><a id="__codelineno-2-23" name="__codelineno-2-23" href="#__codelineno-2-23"></a><span class="p">&lt;</span><span class="nt">h1</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;my-h1&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>
</span><span id="__span-2-24"><a id="__codelineno-2-24" name="__codelineno-2-24" href="#__codelineno-2-24"></a>
</span><span id="__span-2-25"><a id="__codelineno-2-25" name="__codelineno-2-25" href="#__codelineno-2-25"></a><span class="cm">&lt;!-- will populate &lt;h2&gt;PyScript&lt;/h2&gt; --&gt;</span>
</span><span id="__span-2-26"><a id="__codelineno-2-26" name="__codelineno-2-26" href="#__codelineno-2-26"></a><span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;py&quot;</span> <span class="na">worker</span><span class="p">&gt;</span>
</span><span id="__span-2-27"><a id="__codelineno-2-27" name="__codelineno-2-27" href="#__codelineno-2-27"></a><span class="w">    </span><span class="kr">from</span><span class="w"> </span><span class="nx">pyscript</span><span class="w"> </span><span class="k">import</span><span class="w"> </span><span class="nx">display</span>
</span><span id="__span-2-28"><a id="__codelineno-2-28" name="__codelineno-2-28" href="#__codelineno-2-28"></a><span class="w">    </span><span class="nx">display</span><span class="p">(</span><span class="s2">&quot;PyScript&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">target</span><span class="o">=</span><span class="s2">&quot;my-h2&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">append</span><span class="o">=</span><span class="nx">False</span><span class="p">)</span>
</span><span id="__span-2-29"><a id="__codelineno-2-29" name="__codelineno-2-29" href="#__codelineno-2-29"></a><span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</span><span id="__span-2-30"><a id="__codelineno-2-30" name="__codelineno-2-30" href="#__codelineno-2-30"></a><span class="p">&lt;</span><span class="nt">h2</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;my-h2&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">h2</span><span class="p">&gt;</span>
</span></code></pre></div>
<h3 id="pyscriptwhen"><code>pyscript.when</code></h3>
<p>A Python decorator to indicate the decorated function should handle the
specified events for selected elements.</p>
<p>The decorator takes two parameters:</p>
<ul>
<li>The <code>event_type</code> should be the name of the
  <a href="https://developer.mozilla.org/en-US/docs/Web/Events">browser event to handle</a>
  as a string (e.g. <code>"click"</code>).</li>
<li>The <code>selector</code> should be a string containing a
  <a href="https://developer.mozilla.org/en-US/docs/Web/API/Document_object_model/Locating_DOM_elements_using_selectors">valid selector</a>
  to indicate the target elements in the DOM whose events of <code>event_type</code> are
  of interest.</li>
</ul>
<p>The following example has a button with an id of <code>my_button</code> and a decorated
function that handles <code>click</code> events dispatched by the button.</p>
<div class="language-html highlight"><span class="filename">The HTML button</span><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="p">&lt;</span><span class="nt">button</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;my_button&quot;</span><span class="p">&gt;</span>Click me!<span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
</span></code></pre></div>
<div class="language-python highlight"><span class="filename">The decorated Python function to handle click events</span><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="kn">from</span> <span class="nn">pyscript</span> <span class="kn">import</span> <span class="n">when</span><span class="p">,</span> <span class="n">display</span>
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a>
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a>
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a><span class="nd">@when</span><span class="p">(</span><span class="s2">&quot;click&quot;</span><span class="p">,</span> <span class="s2">&quot;#my_button&quot;</span><span class="p">)</span>
</span><span id="__span-4-5"><a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a><span class="k">def</span> <span class="nf">click_handler</span><span class="p">(</span><span class="n">event</span><span class="p">):</span>
</span><span id="__span-4-6"><a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-4-7"><a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a><span class="sd">    Event handlers get an event object representing the activity that raised</span>
</span><span id="__span-4-8"><a id="__codelineno-4-8" name="__codelineno-4-8" href="#__codelineno-4-8"></a><span class="sd">    them.</span>
</span><span id="__span-4-9"><a id="__codelineno-4-9" name="__codelineno-4-9" href="#__codelineno-4-9"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-4-10"><a id="__codelineno-4-10" name="__codelineno-4-10" href="#__codelineno-4-10"></a>    <span class="n">display</span><span class="p">(</span><span class="s2">&quot;I&#39;ve been clicked!&quot;</span><span class="p">)</span>
</span></code></pre></div>
<p>This functionality is related to the <code>py-*</code> or <code>mpy-*</code> <a href="#html-attributes">HTML attributes</a>.</p>
<h3 id="pyscriptjs_modules"><code>pyscript.js_modules</code></h3>
<p>It is possible to <a href="../configuration/#javascript-modules">define JavaScript modules to use within your Python code</a>.</p>
<p>Such named modules will always then be available under the
<code>pyscript.js_modules</code> namespace.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Please see the documentation (linked above) about restrictions and gotchas
when configuring how JavaScript modules are made available to PyScript.</p>
</div>
<h3 id="pyscriptfetch"><code>pyscript.fetch</code></h3>
<p>A common task is to <code>fetch</code> data from the web via HTTP requests. The
<code>pyscript.fetch</code> function provides a uniform way to achieve this in both
Pyodide and MicroPython. It is closely modelled on the
<a href="https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API">Fetch API</a> found
in browsers with some important Pythonic differences.</p>
<p>The simple use case is to pass in a URL and <code>await</code> the response. Remember, in
order to use <code>await</code> you must have the <code>async</code> attribute in the <code>script</code> tag
that references your code. If this request is in a function, that function
should also be defined as <code>async</code>.</p>
<div class="language-python highlight"><span class="filename">A simple HTTP GET with pyscript.fetch</span><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="kn">from</span> <span class="nn">pyscript</span> <span class="kn">import</span> <span class="n">fetch</span>
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a>
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a>
</span><span id="__span-5-4"><a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a><span class="n">response</span> <span class="o">=</span> <span class="k">await</span> <span class="n">fetch</span><span class="p">(</span><span class="s2">&quot;https://example.com&quot;</span><span class="p">)</span>
</span><span id="__span-5-5"><a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a><span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">ok</span><span class="p">:</span>
</span><span id="__span-5-6"><a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a>    <span class="n">data</span> <span class="o">=</span> <span class="k">await</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
</span><span id="__span-5-7"><a id="__codelineno-5-7" name="__codelineno-5-7" href="#__codelineno-5-7"></a><span class="k">else</span><span class="p">:</span>
</span><span id="__span-5-8"><a id="__codelineno-5-8" name="__codelineno-5-8" href="#__codelineno-5-8"></a>    <span class="nb">print</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">status</span><span class="p">)</span>
</span></code></pre></div>
<p>The object returned from an <code>await fetch</code> call will have attributes that
correspond to the
<a href="https://developer.mozilla.org/en-US/docs/Web/API/Response">JavaScript response object</a>.
This is useful for getting response codes, headers and other metadata before
processing the response's data.</p>
<p>Alternatively, rather than using a double <code>await</code> (one to get the response, the
other to grab the data), it's possible to chain the calls into a single
<code>await</code> like this:</p>
<div class="language-python highlight"><span class="filename">A simple HTTP GET as a single await</span><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="kn">from</span> <span class="nn">pyscript</span> <span class="kn">import</span> <span class="n">fetch</span>
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a>
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a><span class="n">data</span> <span class="o">=</span> <span class="k">await</span> <span class="n">fetch</span><span class="p">(</span><span class="s2">&quot;https://example.com&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
</span></code></pre></div>
<p>The following awaitable methods are available to you to access the data
returned from the server:</p>
<ul>
<li><code>arrayBuffer()</code> returns a Python <a href="https://docs.python.org/3/library/stdtypes.html#memoryview">memoryview</a> of the response. This is equivalent to the <a href="https://developer.mozilla.org/en-US/docs/Web/API/Response/arrayBuffer"><code>arrayBuffer()</code> method</a> in the browser based <code>fetch</code> API.</li>
<li><code>blob()</code> returns a JavaScript <a href="https://developer.mozilla.org/en-US/docs/Web/API/Response/blob"><code>blob</code></a> version of the response. This is equivalent
to the <a href="https://developer.mozilla.org/en-US/docs/Web/API/Response/blob"><code>blob()</code> method</a> in the browser based <code>fetch</code> API.</li>
<li><code>bytearray()</code> returns a Python <a href="https://docs.python.org/3/library/stdtypes.html#bytearray"><code>bytearray</code></a> version of the response.</li>
<li><code>json()</code> returns a Python datastructure representing a JSON serialised payload in the response.</li>
<li><code>text()</code> returns a Python string version of the response.</li>
</ul>
<p>The underlying browser <code>fetch</code> API has <a href="https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API/Using_Fetch#supplying_request_options">many request options</a>
that you should simply pass in as keyword arguments like this:</p>
<div class="language-python highlight"><span class="filename">Supplying request options.</span><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="kn">from</span> <span class="nn">pyscript</span> <span class="kn">import</span> <span class="n">fetch</span>
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a>
</span><span id="__span-7-3"><a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a>
</span><span id="__span-7-4"><a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a><span class="n">response</span> <span class="o">=</span> <span class="k">await</span> <span class="n">fetch</span><span class="p">(</span><span class="s2">&quot;https://example.com&quot;</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;POST&quot;</span><span class="p">,</span> <span class="n">body</span><span class="o">=</span><span class="s2">&quot;HELLO&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
</span></code></pre></div>
<div class="admonition danger">
<p class="admonition-title">Danger</p>
<p>You may encounter <a href="https://developer.mozilla.org/en-US/docs/Glossary/CORS">CORS</a> errors (especially with reference to a missing
<a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS/Errors/CORSMissingAllowOrigin">Access-Control-Allow-Origin header</a>.</p>
<p>This is a security feature of modern browsers where the site to which you
are making a request <strong>will not process a request from a site hosted at
another domain</strong>.</p>
<p>For example, if your PyScript app is hosted under <code>example.com</code> and you
make a request to <code>bbc.co.uk</code> (who don't allow requests from other domains)
then you'll encounter this sort of CORS related error.</p>
<p>There is nothing PyScript can do about this problem (it's a feature, not a
bug). However, you could use a pass-through proxy service to get around
this limitation (i.e. the proxy service makes the call on your behalf).</p>
</div>
<h3 id="pyscriptffito_js"><code>pyscript.ffi.to_js</code></h3>
<p>A utility function to convert Python references into their JavaScript
equivalents. For example, a Python dictionary is converted into a JavaScript
object literal (rather than a JavaScript <code>Map</code>), unless a <code>dict_converter</code>
is explicitly specified and the runtime is Pyodide.</p>
<h3 id="pyscriptfficreate_proxy"><code>pyscript.ffi.create_proxy</code></h3>
<p>A utility function explicitly for when a callback function is added via an
event listener. It ensures the function still exists beyond the assignment of
the function to an event. Should you not <code>create_proxy</code> around the callback
function, it will be immediately garbage collected after being bound to the
event.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>In <em>Pyodide</em> it's expected that the created proxy is explicitly destroyed
when it's not needed / used anymore but that <code>proxy.destroy()</code> method has
not been implemented in <em>MicroPython</em> (yet).
To try simplifying this dance and automatically destroy proxies, based on
JS Garbage Collector heuristics, we have introduced an <strong>experimental flag</strong>
called <code>experimental_create_proxy = "auto"</code> which currently tries to be
smart enough to orchestrate the whole proxy creation and destruction dance
out of the box.
If you'd like to try that flag keep in mind you should never need or care about
using explictly <em>create_proxy</em> but like it is with everything experimental,
there might be edge cases we have not (yet) tackled.</p>
</div>
<h3 id="pyscriptcurrent_target"><code>pyscript.current_target</code></h3>
<p>A utility function to retrieve the unique identifier of the element used
to display content. If the element is not a <code>&lt;script&gt;</code> and it has already
an <code>id</code>, that <code>id</code> will be returned.</p>
<div class="language-html highlight"><span class="filename">The current_target utility</span><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="cm">&lt;!-- current_target(): explicit-id --&gt;</span>
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a><span class="p">&lt;</span><span class="nt">mpy-script</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;explicit-id&quot;</span><span class="p">&gt;</span>
</span><span id="__span-8-3"><a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a>    from pyscript import display, current_target
</span><span id="__span-8-4"><a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a>    display(f&quot;current_target(): {current_target()}&quot;)
</span><span id="__span-8-5"><a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a><span class="p">&lt;/</span><span class="nt">mpy-script</span><span class="p">&gt;</span>
</span><span id="__span-8-6"><a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a>
</span><span id="__span-8-7"><a id="__codelineno-8-7" name="__codelineno-8-7" href="#__codelineno-8-7"></a><span class="cm">&lt;!-- current_target(): mpy-0 --&gt;</span>
</span><span id="__span-8-8"><a id="__codelineno-8-8" name="__codelineno-8-8" href="#__codelineno-8-8"></a><span class="p">&lt;</span><span class="nt">mpy-script</span><span class="p">&gt;</span>
</span><span id="__span-8-9"><a id="__codelineno-8-9" name="__codelineno-8-9" href="#__codelineno-8-9"></a>    from pyscript import display, current_target
</span><span id="__span-8-10"><a id="__codelineno-8-10" name="__codelineno-8-10" href="#__codelineno-8-10"></a>    display(f&quot;current_target(): {current_target()}&quot;)
</span><span id="__span-8-11"><a id="__codelineno-8-11" name="__codelineno-8-11" href="#__codelineno-8-11"></a><span class="p">&lt;/</span><span class="nt">mpy-script</span><span class="p">&gt;</span>
</span><span id="__span-8-12"><a id="__codelineno-8-12" name="__codelineno-8-12" href="#__codelineno-8-12"></a>
</span><span id="__span-8-13"><a id="__codelineno-8-13" name="__codelineno-8-13" href="#__codelineno-8-13"></a><span class="cm">&lt;!-- current_target(): mpy-1 --&gt;</span>
</span><span id="__span-8-14"><a id="__codelineno-8-14" name="__codelineno-8-14" href="#__codelineno-8-14"></a><span class="cm">&lt;!-- creates right after the &lt;script&gt;:</span>
</span><span id="__span-8-15"><a id="__codelineno-8-15" name="__codelineno-8-15" href="#__codelineno-8-15"></a><span class="cm">    &lt;script-py id=&quot;mpy-1&quot;&gt;</span>
</span><span id="__span-8-16"><a id="__codelineno-8-16" name="__codelineno-8-16" href="#__codelineno-8-16"></a><span class="cm">        &lt;div&gt;current_target(): mpy-1&lt;/div&gt;</span>
</span><span id="__span-8-17"><a id="__codelineno-8-17" name="__codelineno-8-17" href="#__codelineno-8-17"></a><span class="cm">    &lt;/script-py&gt;</span>
</span><span id="__span-8-18"><a id="__codelineno-8-18" name="__codelineno-8-18" href="#__codelineno-8-18"></a><span class="cm">--&gt;</span>
</span><span id="__span-8-19"><a id="__codelineno-8-19" name="__codelineno-8-19" href="#__codelineno-8-19"></a><span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;mpy&quot;</span><span class="p">&gt;</span>
</span><span id="__span-8-20"><a id="__codelineno-8-20" name="__codelineno-8-20" href="#__codelineno-8-20"></a><span class="w">    </span><span class="kr">from</span><span class="w"> </span><span class="nx">pyscript</span><span class="w"> </span><span class="k">import</span><span class="w"> </span><span class="nx">display</span><span class="p">,</span><span class="w"> </span><span class="nx">current_target</span>
</span><span id="__span-8-21"><a id="__codelineno-8-21" name="__codelineno-8-21" href="#__codelineno-8-21"></a><span class="w">    </span><span class="nx">display</span><span class="p">(</span><span class="nx">f</span><span class="s2">&quot;current_target(): {current_target()}&quot;</span><span class="p">)</span>
</span><span id="__span-8-22"><a id="__codelineno-8-22" name="__codelineno-8-22" href="#__codelineno-8-22"></a><span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</span></code></pre></div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Please note that <code>current_target()</code> points at a visible element on the page,
<strong>not</strong> at the current <code>&lt;script&gt;</code> that is executing the code.
If you need to explicitly reach the <code>&lt;script&gt;</code> element, you can always assign
an <code>id</code> to it so that at any time, within any listener or functionality,
you can <code>document.getElementById(script_id)</code> to reach out that element:
<code>&lt;script type="mpy" id="unique-id"&gt;...&lt;/script&gt;</code></p>
</div>
<h3 id="pyscripthtml"><code>pyscript.HTML</code></h3>
<p>A class utility able to wrap a generic content and display it on the page.
The content can be any of these mime types:</p>
<ul>
<li><code>text/plain</code> to show the content as text</li>
<li><code>text/html</code> to show the content as <em>HTML</em></li>
<li><code>image/png</code> to show the content as <code>&lt;img&gt;</code></li>
<li><code>image/jpeg</code> to show the content as <code>&lt;img&gt;</code></li>
<li><code>image/svg+xml</code> to show the content as <code>&lt;svg&gt;</code></li>
<li><code>application/json</code> to show the content as <em>JSON</em></li>
<li><code>application/javascript</code> to put the content in <code>&lt;script&gt;</code> (discouraged)</li>
</ul>
<div class="language-html highlight"><span class="filename">The HTML class</span><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="cm">&lt;!-- display escaped text:</span>
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a><span class="cm">    &amp;lt;em&amp;gt;em&amp;lt;/em&amp;gt;</span>
</span><span id="__span-9-3"><a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a><span class="cm">--&gt;</span>
</span><span id="__span-9-4"><a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a><span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;mpy&quot;</span><span class="p">&gt;</span>
</span><span id="__span-9-5"><a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a><span class="w">    </span><span class="kr">from</span><span class="w"> </span><span class="nx">pyscript</span><span class="w"> </span><span class="k">import</span><span class="w"> </span><span class="nx">display</span><span class="p">,</span><span class="w"> </span><span class="nx">HTML</span>
</span><span id="__span-9-6"><a id="__codelineno-9-6" name="__codelineno-9-6" href="#__codelineno-9-6"></a><span class="w">    </span><span class="nx">display</span><span class="p">(</span><span class="s2">&quot;&lt;em&gt;em&lt;/em&gt;&quot;</span><span class="p">)</span>
</span><span id="__span-9-7"><a id="__codelineno-9-7" name="__codelineno-9-7" href="#__codelineno-9-7"></a><span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</span><span id="__span-9-8"><a id="__codelineno-9-8" name="__codelineno-9-8" href="#__codelineno-9-8"></a>
</span><span id="__span-9-9"><a id="__codelineno-9-9" name="__codelineno-9-9" href="#__codelineno-9-9"></a><span class="cm">&lt;!-- display exactly this HTML:</span>
</span><span id="__span-9-10"><a id="__codelineno-9-10" name="__codelineno-9-10" href="#__codelineno-9-10"></a><span class="cm">    &lt;em&gt;em&lt;/em&gt;</span>
</span><span id="__span-9-11"><a id="__codelineno-9-11" name="__codelineno-9-11" href="#__codelineno-9-11"></a><span class="cm">--&gt;</span>
</span><span id="__span-9-12"><a id="__codelineno-9-12" name="__codelineno-9-12" href="#__codelineno-9-12"></a><span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;mpy&quot;</span><span class="p">&gt;</span>
</span><span id="__span-9-13"><a id="__codelineno-9-13" name="__codelineno-9-13" href="#__codelineno-9-13"></a><span class="w">    </span><span class="kr">from</span><span class="w"> </span><span class="nx">pyscript</span><span class="w"> </span><span class="k">import</span><span class="w"> </span><span class="nx">display</span><span class="p">,</span><span class="w"> </span><span class="nx">HTML</span>
</span><span id="__span-9-14"><a id="__codelineno-9-14" name="__codelineno-9-14" href="#__codelineno-9-14"></a><span class="w">    </span><span class="nx">display</span><span class="p">(</span><span class="nx">HTML</span><span class="p">(</span><span class="s2">&quot;&lt;em&gt;em&lt;/em&gt;&quot;</span><span class="p">))</span>
</span><span id="__span-9-15"><a id="__codelineno-9-15" name="__codelineno-9-15" href="#__codelineno-9-15"></a><span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</span></code></pre></div>
<h3 id="pyscriptrunning_in_worker"><code>pyscript.RUNNING_IN_WORKER</code></h3>
<p>This constant indicates when the current code is running within a <em>worker</em> or within the <em>main</em> thread.</p>
<p>It is <code>True</code> when the current code is executing in a <em>worker</em>, <code>False</code> when the code is running on <em>main</em>.</p>
<h2 id="main-thread-only-features">Main-thread only features</h2>
<h3 id="pyscriptpyworker"><code>pyscript.PyWorker</code></h3>
<p>A class used to instantiate a new worker from within Python.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>We currently changed names within the JS module's exports to
bootstrap and disambiguate <code>PyWorker</code> from <code>MPWorker</code> and
automatically use the right interpreter behind the scene.
The Python class currently is always named <code>PyWorker</code> and
it requires at least a valid <code>type</code> option, <a href="https://pyscript.github.io/polyscript/#xworker-options">among others</a>,
which must be either <code>micropython</code> or <code>pyodide</code>.
We will keep this feature alive but in the future this might default
to <code>pyodide</code> unless a new <code>MPWorker</code> class is also exported which will
default to <code>micropython</code> instead. The explicit <code>type</code> would still exist.</p>
</div>
<p>The following fragment demonstrates who to start the Python code in the file
<code>worker.py</code> on a new worker from within Python.</p>
<div class="language-html highlight"><span class="filename">Starting a new worker from Python</span><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;mpy&quot;</span><span class="p">&gt;</span>
</span><span id="__span-10-2"><a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a><span class="w">    </span><span class="kr">from</span><span class="w"> </span><span class="nx">pyscript</span><span class="w"> </span><span class="k">import</span><span class="w"> </span><span class="nx">PyWorker</span>
</span><span id="__span-10-3"><a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a>
</span><span id="__span-10-4"><a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a><span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="nx">type</span><span class="w"> </span><span class="nx">can</span><span class="w"> </span><span class="nx">be</span><span class="w"> </span><span class="nx">either</span><span class="w"> </span><span class="sb">`micropython`</span><span class="w"> </span><span class="nx">or</span><span class="w"> </span><span class="sb">`pyodide`</span>
</span><span id="__span-10-5"><a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a><span class="w">    </span><span class="nx">PyWorker</span><span class="p">(</span><span class="s2">&quot;worker.py&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">type</span><span class="o">=</span><span class="s2">&quot;micropython&quot;</span><span class="p">)</span>
</span><span id="__span-10-6"><a id="__codelineno-10-6" name="__codelineno-10-6" href="#__codelineno-10-6"></a><span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</span><span id="__span-10-7"><a id="__codelineno-10-7" name="__codelineno-10-7" href="#__codelineno-10-7"></a><span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;output&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</span></code></pre></div>
<div class="language-python highlight"><span class="filename">the worker.py content</span><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="kn">from</span> <span class="nn">pyscript</span> <span class="kn">import</span> <span class="n">RUNNING_IN_WORKER</span><span class="p">,</span> <span class="n">display</span><span class="p">,</span> <span class="n">sync</span>
</span><span id="__span-11-2"><a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a>
</span><span id="__span-11-3"><a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a><span class="n">display</span><span class="p">(</span><span class="s2">&quot;Hello World&quot;</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="s2">&quot;output&quot;</span><span class="p">,</span> <span class="n">append</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-11-4"><a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a>
</span><span id="__span-11-5"><a id="__codelineno-11-5" name="__codelineno-11-5" href="#__codelineno-11-5"></a><span class="c1"># will log into devtools console</span>
</span><span id="__span-11-6"><a id="__codelineno-11-6" name="__codelineno-11-6" href="#__codelineno-11-6"></a><span class="nb">print</span><span class="p">(</span><span class="n">RUNNING_IN_WORKER</span><span class="p">)</span>  <span class="c1"># True</span>
</span><span id="__span-11-7"><a id="__codelineno-11-7" name="__codelineno-11-7" href="#__codelineno-11-7"></a><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;sleeping&quot;</span><span class="p">)</span>
</span><span id="__span-11-8"><a id="__codelineno-11-8" name="__codelineno-11-8" href="#__codelineno-11-8"></a><span class="n">sync</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span><span id="__span-11-9"><a id="__codelineno-11-9" name="__codelineno-11-9" href="#__codelineno-11-9"></a><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;awake&quot;</span><span class="p">)</span>
</span></code></pre></div>
<h2 id="worker-only-features">Worker only features</h2>
<h3 id="pyscriptsync"><code>pyscript.sync</code></h3>
<p>A function used to pass serializable data from workers to the main thread. </p>
<p>Imagine you have this code on the main thread:</p>
<div class="language-python highlight"><span class="filename">Python code on the main thread</span><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="kn">from</span> <span class="nn">pyscript</span> <span class="kn">import</span> <span class="n">PyWorker</span>
</span><span id="__span-12-2"><a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a>
</span><span id="__span-12-3"><a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a><span class="k">def</span> <span class="nf">hello</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;world&quot;</span><span class="p">):</span>
</span><span id="__span-12-4"><a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a>    <span class="n">display</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Hello, </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-12-5"><a id="__codelineno-12-5" name="__codelineno-12-5" href="#__codelineno-12-5"></a>
</span><span id="__span-12-6"><a id="__codelineno-12-6" name="__codelineno-12-6" href="#__codelineno-12-6"></a><span class="n">worker</span> <span class="o">=</span> <span class="n">PyWorker</span><span class="p">(</span><span class="s2">&quot;./worker.py&quot;</span><span class="p">)</span>
</span><span id="__span-12-7"><a id="__codelineno-12-7" name="__codelineno-12-7" href="#__codelineno-12-7"></a><span class="n">worker</span><span class="o">.</span><span class="n">sync</span><span class="o">.</span><span class="n">hello</span> <span class="o">=</span> <span class="n">hello</span>
</span></code></pre></div>
<p>In the code on the worker, you can pass data back to handler functions like
this:</p>
<div class="language-python highlight"><span class="filename">Pass data back to the main thread from a worker</span><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="kn">from</span> <span class="nn">pyscript</span> <span class="kn">import</span> <span class="n">sync</span>
</span><span id="__span-13-2"><a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a>
</span><span id="__span-13-3"><a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a><span class="n">sync</span><span class="o">.</span><span class="n">hello</span><span class="p">(</span><span class="s2">&quot;PyScript&quot;</span><span class="p">)</span>
</span></code></pre></div>
<h2 id="html-attributes">HTML attributes</h2>
<p>As a convenience, and to ensure backwards compatibility, PyScript allows the
use of inline event handlers via custom HTML attributes.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This classic pattern of coding (inline event handlers) is no longer
considered good practice in web development circles.</p>
<p>We include this behaviour for historic reasons, but the folks at
Mozilla <a href="https://developer.mozilla.org/en-US/docs/Learn/JavaScript/Building_blocks/Events#inline_event_handlers_%E2%80%94_dont_use_these">have a good explanation</a>
of why this is currently considered bad practice.</p>
</div>
<p>These attributes are expressed as <code>py-*</code> or <code>mpy-*</code> attributes of an HTML element that
reference the name of a Python function to run when the event is fired. You
should replace the <code>*</code> with the <em>actual name of an event</em> (e.g. <code>py-click</code> or <code>mpy-click</code>).
This is similar to how all
<a href="https://html.spec.whatwg.org/multipage/webappapis.html#event-handlers-on-elements,-document-objects,-and-window-objects">event handlers on elements</a>
start with <code>on</code> in standard HTML (e.g. <code>onclick</code>). The rule of thumb is to
simply replace <code>on</code> with <code>py-</code> and then reference the name of a Python
function.</p>
<div class="language-html highlight"><span class="filename">A py-click event on an HTML button element.</span><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="p">&lt;</span><span class="nt">button</span> <span class="na">py-click</span><span class="o">=</span><span class="s">&quot;handle_click&quot;</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;my_button&quot;</span><span class="p">&gt;</span>Click me!<span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
</span></code></pre></div>
<div class="language-python highlight"><span class="filename">The related Python function.</span><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a><span class="kn">from</span> <span class="nn">pyscript</span> <span class="kn">import</span> <span class="n">window</span>
</span><span id="__span-15-2"><a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a>
</span><span id="__span-15-3"><a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a>
</span><span id="__span-15-4"><a id="__codelineno-15-4" name="__codelineno-15-4" href="#__codelineno-15-4"></a><span class="k">def</span> <span class="nf">handle_click</span><span class="p">(</span><span class="n">event</span><span class="p">):</span>
</span><span id="__span-15-5"><a id="__codelineno-15-5" name="__codelineno-15-5" href="#__codelineno-15-5"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-15-6"><a id="__codelineno-15-6" name="__codelineno-15-6" href="#__codelineno-15-6"></a><span class="sd">    Simply log the click event to the browser&#39;s console.</span>
</span><span id="__span-15-7"><a id="__codelineno-15-7" name="__codelineno-15-7" href="#__codelineno-15-7"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-15-8"><a id="__codelineno-15-8" name="__codelineno-15-8" href="#__codelineno-15-8"></a>    <span class="n">window</span><span class="o">.</span><span class="n">console</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>    
</span></code></pre></div>
<p>Under the hood, the <a href="#pyscriptwhen"><code>pyscript.when</code></a> decorator is used to
enable this behaviour.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In earlier versions of PyScript, the value associated with the attribute
was simply evaluated by the Python interpreter. This was unsafe:
manipulation of the attribute's value could have resulted in the evaluation
of arbitrary code.</p>
<p>This is why we changed to the current behaviour: just supply the name
of the Python function to be evaluated, and PyScript will do this safely.</p>
</div>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["content.code.copy", "content.code.annotate"], "search": "../../assets/javascripts/workers/search.dfff1995.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.dff1b7c8.min.js"></script>
      
    
  </body>
</html>