
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../architecture/">
      
      
        <link rel="next" href="../dom/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.0, mkdocs-material-9.3.1">
    
    
      
        <title>Configuration - PyScript</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.046329b4.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.85d0ee34.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="orange" data-md-color-accent="indigo">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#configuration" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="PyScript" class="md-header__button md-logo" aria-label="PyScript" data-md-component="logo">
      
  <img src="../../assets/images/pyscript-black.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            PyScript
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Configuration
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="orange" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_3" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9h-1.9M20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69m-9.15 3.96h2.3L12 9l-1.15 3.65Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="orange" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="orange" data-md-color-accent="indigo"  aria-label="Switch to system preference"  type="radio" name="__palette" id="__palette_3">
    
      <label class="md-header__button md-icon" title="Switch to system preference" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
</form>
      
    
    
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="PyScript" class="md-nav__button md-logo" aria-label="PyScript" data-md-component="logo">
      
  <img src="../../assets/images/pyscript-black.svg" alt="logo">

    </a>
    PyScript
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../../beginning-pyscript/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Beginning PyScript
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../../conduct/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Code of Conduct
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../../contributing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Contributing
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Developer Guide
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../../license/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    License
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" checked>
        
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    User guide
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            User guide
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../what/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    What is PyScript?
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../features/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Features
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../first-steps/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    First steps
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../architecture/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Architecture
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Configuration
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Configuration
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#toml-or-json" class="md-nav__link">
    TOML or JSON
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#file-or-inline" class="md-nav__link">
    File or inline
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#options" class="md-nav__link">
    Options
  </a>
  
    <nav class="md-nav" aria-label="Options">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#interpreter" class="md-nav__link">
    Interpreter
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#files" class="md-nav__link">
    Files
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#packages" class="md-nav__link">
    Packages
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#plugins" class="md-nav__link">
    Plugins
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#javascript-modules" class="md-nav__link">
    JavaScript modules
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#custom" class="md-nav__link">
    Custom
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../dom/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    The DOM &amp; JavaScript
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../workers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Workers
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../builtins/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Builtin helpers
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../terminal/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Python terminal
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../editor/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Python editor
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../plugins/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Plugins
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../offline/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Use Offline
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../examples/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Example apps
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#toml-or-json" class="md-nav__link">
    TOML or JSON
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#file-or-inline" class="md-nav__link">
    File or inline
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#options" class="md-nav__link">
    Options
  </a>
  
    <nav class="md-nav" aria-label="Options">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#interpreter" class="md-nav__link">
    Interpreter
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#files" class="md-nav__link">
    Files
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#packages" class="md-nav__link">
    Packages
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#plugins" class="md-nav__link">
    Plugins
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#javascript-modules" class="md-nav__link">
    JavaScript modules
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#custom" class="md-nav__link">
    Custom
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="configuration">Configuration</h1>
<p>The browser tab in which your PyScript based web page is displayed is a very
secure sandboxed computing environment for running your Python code.</p>
<p>This is also the case for web workers running Python. Despite being associated
with a single web page, workers are completely separate from each other
(except for some very limited and clearly defined means of interacting, which
PyScript looks after for you).</p>
<p>We need to tell PyScript how we want such Python environments to be configured.
This works in the same way for both the main thread and for web workers. Such
configuration ensures we get the expected resources ready before our Python
code is evaluated (resources such as arbitrary data files, third party Python
packages and PyScript plugins).</p>
<h2 id="toml-or-json">TOML or JSON</h2>
<p>Configuration can be expressed in two formats:</p>
<ul>
<li><a href="https://toml.io/en/">TOML</a> is the configuration file format preferred by
  folks in the Python community.</li>
<li><a href="https://www.json.org/json-en.html">JSON</a> is a data format most often used
  by folks in the web community.</li>
</ul>
<p>Since PyScript is the marriage of Python and the web, and we respect the
traditions of both technical cultures, we support both formats.</p>
<p>However, because JSON is built into all browsers by default and TOML requires
an additional download of a specialist parser before PyScript can work, <strong>the
use of JSON is more efficient from a performance point of view</strong>.</p>
<p>The following two configurations are equivalent, and simply tell PyScript to
ensure the packages <a href="https://arrr.readthedocs.io/en/latest/">arrr</a> and
<a href="https://numberwang.readthedocs.io/en/latest/">numberwang</a> are installed from
PyPI (the <a href="https://pypi.org/">Python Packaging Index</a>):</p>
<div class="language-TOML highlight"><span class="filename">Configuration via TOML</span><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">packages</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;arrr&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;numberwang&quot;</span><span class="w"> </span><span class="p">]</span>
</span></code></pre></div>
<div class="language-JSON highlight"><span class="filename">Configuration via JSON</span><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="p">{</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="w">    </span><span class="nt">&quot;packages&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;arrr&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;numberwang&quot;</span><span class="p">]</span>
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="p">}</span>
</span></code></pre></div>
<h2 id="file-or-inline">File or inline</h2>
<p>The recommended way to write configuration is via a separate file and then
reference it from the tag used to specify the Python code:</p>
<div class="language-HTML highlight"><span class="filename">Reference a configuration file</span><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;py&quot;</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;main.py&quot;</span> <span class="na">config</span><span class="o">=</span><span class="s">&quot;pyscript.toml&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</span></code></pre></div>
<p>If you use JSON, you can make it the value of the <code>config</code> attribute:</p>
<div class="language-HTML highlight"><span class="filename">JSON as the value of the config attribute</span><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;mpy&quot;</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;main.py&quot;</span> <span class="na">config</span><span class="o">=</span><span class="s">&#39;{&quot;packages&quot;:[&quot;arrr&quot;, &quot;numberwang&quot;]}&#39;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</span></code></pre></div>
<p>For historical and convenience reasons we still support the inline
specification of configuration information via a <em>single</em> <code>&lt;py-config&gt;</code> or
<code>&lt;mpy-config&gt;</code> tag in your HTML document:</p>
<div class="language-HTML highlight"><span class="filename">Inline configuration via the &lt;py-config&gt; tag</span><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="p">&lt;</span><span class="nt">py-config</span><span class="p">&gt;</span>
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a>{
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a>    &quot;packages&quot;: [&quot;arrr&quot;, &quot;numberwang&quot; ]
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a>}
</span><span id="__span-4-5"><a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a><span class="p">&lt;/</span><span class="nt">py-config</span><span class="p">&gt;</span>
</span></code></pre></div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Should you use <code>&lt;py-config&gt;</code> or <code>&lt;mpy-config&gt;</code>, <strong>there must be only one of
these tags on the page per interpreter</strong>.</p>
</div>
<h2 id="options">Options</h2>
<p>There are five core options (<a href="#interpreter"><code>interpreter</code></a>, <a href="#files"><code>files</code></a>,
<a href="#packages"><code>packages</code></a>, <a href="#plugins"><code>plugins</code></a> and
<a href="#javascript-modules"><code>js_modules</code></a>.) The user is free to define
arbitrary additional configuration options that plugins or an app may require
for their own reasons.</p>
<h3 id="interpreter">Interpreter</h3>
<p>The <code>interpreter</code> option pins the Python interpreter to the version of the
specified value. This is useful for testing (does my code work on a specific
version of Pyodide?), or to ensure the precise combination of PyScript version
and interpreter version are pinned to known values.</p>
<p>The value of the <code>interpreter</code> option should be a valid version number
for the Python interpreter you are configuring, or a fully qualified URL to
a custom version of the interpreter.</p>
<p>The following two examples are equivalent:</p>
<div class="language-TOML highlight"><span class="filename">Specify the interpreter version in TOML</span><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="n">interpreter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;0.23.4&quot;</span>
</span></code></pre></div>
<div class="language-JSON highlight"><span class="filename">Specify the interpreter version in JSON</span><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="p">{</span>
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a><span class="w">    </span><span class="nt">&quot;interpreter&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;0.23.4&quot;</span>
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a><span class="p">}</span>
</span></code></pre></div>
<p>The following JSON fragment uses a fully qualified URL to point to the same
version of Pyodide as specified in the previous examples:</p>
<div class="language-JSON highlight"><span class="filename">Specify the interpreter via a fully qualified URL</span><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="p">{</span>
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a><span class="w">    </span><span class="nt">&quot;interpreter&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;https://cdn.jsdelivr.net/pyodide/v0.23.4/full/pyodide.mjs&quot;</span>
</span><span id="__span-7-3"><a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a><span class="p">}</span>
</span></code></pre></div>
<h3 id="files">Files</h3>
<p>The <code>files</code> option fetches arbitrary content from URLs onto the filesystem
available to Python, and emulated by the browser. Just map a valid URL to a
destination filesystem path.</p>
<p>The following JSON and TOML are equivalent:</p>
<div class="language-json highlight"><span class="filename">Fetch files onto the filesystem with JSON</span><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="p">{</span>
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a><span class="w">  </span><span class="nt">&quot;files&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-8-3"><a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a><span class="w">    </span><span class="nt">&quot;https://example.com/data.csv&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;./data.csv&quot;</span><span class="p">,</span>
</span><span id="__span-8-4"><a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a><span class="w">    </span><span class="nt">&quot;/code.py&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;./subdir/code.py&quot;</span>
</span><span id="__span-8-5"><a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-8-6"><a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a><span class="p">}</span>
</span></code></pre></div>
<div class="language-toml highlight"><span class="filename">Fetch files onto the filesystem with TOML</span><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="k">[files]</span>
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a><span class="s2">&quot;https://example.com/data.csv&quot;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;./data.csv&quot;</span>
</span><span id="__span-9-3"><a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a><span class="s2">&quot;/code.py&quot;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;./subdir/code.py&quot;</span>
</span></code></pre></div>
<p>If you make the target an empty string, the final "filename" part of the source
URL becomes the destination filename, in the root of the filesystem, to which
the content is copied. As a result, the <code>data.csv</code> entry from the previous
examples could be equivalently re-written as:</p>
<div class="language-json highlight"><span class="filename">JSON implied filename in the root directory</span><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="p">{</span>
</span><span id="__span-10-2"><a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a><span class="w">  </span><span class="nt">&quot;files&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-10-3"><a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a><span class="w">    </span><span class="nt">&quot;https://example.com/data.csv&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="__span-10-4"><a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a><span class="w">    </span><span class="err">...</span><span class="w"> </span><span class="err">e</span><span class="kc">t</span><span class="err">c</span><span class="w"> </span><span class="err">...</span>
</span><span id="__span-10-5"><a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-10-6"><a id="__codelineno-10-6" name="__codelineno-10-6" href="#__codelineno-10-6"></a><span class="p">}</span>
</span></code></pre></div>
<div class="language-toml highlight"><span class="filename">TOML implied filename in the root directory</span><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="k">[files]</span>
</span><span id="__span-11-2"><a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a><span class="s2">&quot;https://example.com/data.csv&quot;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;&quot;</span>
</span><span id="__span-11-3"><a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a><span class="p">...</span><span class="w"> </span><span class="n">etc</span><span class="w"> </span><span class="p">...</span>
</span></code></pre></div>
<p>If the source part of the configuration is either a <code>.zip</code> or <code>.tar.gz</code> file
and its destination is a folder path followed by a star (e.g. <code>/*</code> or
<code>./dest/*</code>), then PyScript will extract the referenced archive automatically
into the target directory in the browser's built in file system.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p><strong>PyScript expects all file destinations to be unique.</strong></p>
<p>If there is a duplication PyScript will raise an exception to help you find
the problem.</p>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p><strong>For most people, most of the time, the simple URL to filename mapping,
described above, will be sufficient.</strong></p>
<p>Yet certain situations may require more flexibility. In which case, read
on.</p>
</div>
<p>Sometimes many resources are needed to be fetched from a single location and
copied into the same directory on the file system. To aid readability and
reduce repetition, the <code>files</code> option comes with a mini
<a href="https://en.wikipedia.org/wiki/Template_processor">templating language</a>
that allows reusable placeholders to be defined between curly brackets (<code>{</code>
and <code>}</code>). When these placeholders are encountered in the <code>files</code> configuration,
their name is replaced with their associated value.</p>
<div class="admonition attention">
<p class="admonition-title">Attention</p>
<p>Valid placeholder names are always enclosed between curly brackets
(<code>{</code> and <code>}</code>), like this: <code>{FROM}</code>, <code>{TO}</code> and <code>{DATA SOURCE}</code>
(capitalized names help identify placeholders
when reading code ~ although this isn't strictly necessary).</p>
<p>Any number of placeholders can be defined and used anywhere within URLs and
paths that map source to destination.</p>
</div>
<p>The following JSON and TOML are equivalent:</p>
<div class="language-json highlight"><span class="filename">Using the template language in JSON</span><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="p">{</span>
</span><span id="__span-12-2"><a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a><span class="w">  </span><span class="nt">&quot;files&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-12-3"><a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a><span class="w">    </span><span class="nt">&quot;{DOMAIN}&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;https://my-server.com&quot;</span><span class="p">,</span>
</span><span id="__span-12-4"><a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a><span class="w">    </span><span class="nt">&quot;{PATH}&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;a/path&quot;</span><span class="p">,</span>
</span><span id="__span-12-5"><a id="__codelineno-12-5" name="__codelineno-12-5" href="#__codelineno-12-5"></a><span class="w">    </span><span class="nt">&quot;{VERSION}&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;1.2.3&quot;</span><span class="p">,</span>
</span><span id="__span-12-6"><a id="__codelineno-12-6" name="__codelineno-12-6" href="#__codelineno-12-6"></a><span class="w">    </span><span class="nt">&quot;{FROM}&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;{DOMAIN}/{PATH}/{VERSION}&quot;</span><span class="p">,</span>
</span><span id="__span-12-7"><a id="__codelineno-12-7" name="__codelineno-12-7" href="#__codelineno-12-7"></a><span class="w">    </span><span class="nt">&quot;{TO}&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;./my_module&quot;</span><span class="p">,</span>
</span><span id="__span-12-8"><a id="__codelineno-12-8" name="__codelineno-12-8" href="#__codelineno-12-8"></a><span class="w">    </span><span class="nt">&quot;{FROM}/__init__.py&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;{TO}/__init__.py&quot;</span><span class="p">,</span>
</span><span id="__span-12-9"><a id="__codelineno-12-9" name="__codelineno-12-9" href="#__codelineno-12-9"></a><span class="w">    </span><span class="nt">&quot;{FROM}/foo.py&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;{TO}/foo.py&quot;</span><span class="p">,</span>
</span><span id="__span-12-10"><a id="__codelineno-12-10" name="__codelineno-12-10" href="#__codelineno-12-10"></a><span class="w">    </span><span class="nt">&quot;{FROM}/bar.py&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;{TO}/bar.py&quot;</span><span class="p">,</span>
</span><span id="__span-12-11"><a id="__codelineno-12-11" name="__codelineno-12-11" href="#__codelineno-12-11"></a><span class="w">    </span><span class="nt">&quot;{FROM}/baz.py&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;{TO}/baz.py&quot;</span><span class="p">,</span>
</span><span id="__span-12-12"><a id="__codelineno-12-12" name="__codelineno-12-12" href="#__codelineno-12-12"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-12-13"><a id="__codelineno-12-13" name="__codelineno-12-13" href="#__codelineno-12-13"></a><span class="p">}</span>
</span></code></pre></div>
<div class="language-toml highlight"><span class="filename">Using the template language in TOML</span><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="k">[files]</span>
</span><span id="__span-13-2"><a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a><span class="s2">&quot;{DOMAIN}&quot;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;https://my-server.com&quot;</span>
</span><span id="__span-13-3"><a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a><span class="s2">&quot;{PATH}&quot;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;a/path&quot;</span>
</span><span id="__span-13-4"><a id="__codelineno-13-4" name="__codelineno-13-4" href="#__codelineno-13-4"></a><span class="s2">&quot;{VERSION}&quot;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;1.2.3&quot;</span>
</span><span id="__span-13-5"><a id="__codelineno-13-5" name="__codelineno-13-5" href="#__codelineno-13-5"></a><span class="s2">&quot;{FROM}&quot;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;{DOMAIN}/{PATH}/{VERSION}&quot;</span>
</span><span id="__span-13-6"><a id="__codelineno-13-6" name="__codelineno-13-6" href="#__codelineno-13-6"></a><span class="s2">&quot;{TO}&quot;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;./my_module&quot;</span>
</span><span id="__span-13-7"><a id="__codelineno-13-7" name="__codelineno-13-7" href="#__codelineno-13-7"></a><span class="s2">&quot;{FROM}/__init__.py&quot;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;{TO}/__init__.py&quot;</span>
</span><span id="__span-13-8"><a id="__codelineno-13-8" name="__codelineno-13-8" href="#__codelineno-13-8"></a><span class="s2">&quot;{FROM}/foo.py&quot;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;{TO}/foo.py&quot;</span>
</span><span id="__span-13-9"><a id="__codelineno-13-9" name="__codelineno-13-9" href="#__codelineno-13-9"></a><span class="s2">&quot;{FROM}/bar.py&quot;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;{TO}/bar.py&quot;</span>
</span><span id="__span-13-10"><a id="__codelineno-13-10" name="__codelineno-13-10" href="#__codelineno-13-10"></a><span class="s2">&quot;{FROM}/baz.py&quot;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;{TO}/baz.py&quot;</span>
</span></code></pre></div>
<p>The <code>{DOMAIN}</code>, <code>{PATH}</code>, and <code>{VERSION}</code> placeholders are
used to create a further <code>{FROM}</code> placeholder. The <code>{TO}</code> placeholder is also
defined to point to a common sub-directory on the file system. The final four
entries use <code>{FROM}</code> and <code>{TO}</code> to copy over four files (<code>__init__.py</code>,
<code>foo.py</code>, <code>bar.py</code> and <code>baz.py</code>) from the same source to a common destination
directory.</p>
<p>For convenience, if the destination is just a directory (it ends with <code>/</code>)
then PyScript automatically uses the filename part of the source URL as the
filename in the destination directory.</p>
<p>For example, the end of the previous config file could be:</p>
<div class="language-toml highlight"><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="s2">&quot;{TO}&quot;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;./my_module/&quot;</span>
</span><span id="__span-14-2"><a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a><span class="s2">&quot;{FROM}/__init__.py&quot;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;{TO}&quot;</span>
</span><span id="__span-14-3"><a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a><span class="s2">&quot;{FROM}/foo.py&quot;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;{TO}&quot;</span>
</span><span id="__span-14-4"><a id="__codelineno-14-4" name="__codelineno-14-4" href="#__codelineno-14-4"></a><span class="s2">&quot;{FROM}/bar.py&quot;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;{TO}&quot;</span>
</span><span id="__span-14-5"><a id="__codelineno-14-5" name="__codelineno-14-5" href="#__codelineno-14-5"></a><span class="s2">&quot;{FROM}/baz.py&quot;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;{TO}&quot;</span>
</span></code></pre></div>
<h3 id="packages">Packages</h3>
<p>The <code>packages</code> option defines a list of Python <code>packages</code> to be installed from
<a href="https://pypi.org/">PyPI</a> onto the filesystem by Pyodide's 
<a href="https://micropip.pyodide.org/en/stable/index.html">micropip</a> package
installer.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Because <code>micropip</code> is a Pyodide-only feature, and MicroPython doesn't
support code packaged on PyPI, <strong>the <code>packages</code> option is only available
for use with Pyodide</strong>.</p>
<p>If you need <strong>Python modules for MicroPython</strong>, use the
<a href="#files">files</a> option to manually copy the source code onto the
file system.</p>
</div>
<p>The following two examples are equivalent:</p>
<div class="language-TOML highlight"><span class="filename">A packages list in TOML</span><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a><span class="n">packages</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;arrr&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;numberwang&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;snowballstemmer&gt;=2.2.0&quot;</span><span class="w"> </span><span class="p">]</span>
</span></code></pre></div>
<div class="language-JSON highlight"><span class="filename">A packages list in JSON</span><pre><span></span><code><span id="__span-16-1"><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a><span class="p">{</span>
</span><span id="__span-16-2"><a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a><span class="w">    </span><span class="nt">&quot;packages&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;arrr&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;numberwang&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;snowballstemmer&gt;=2.2.0&quot;</span><span class="w"> </span><span class="p">]</span>
</span><span id="__span-16-3"><a id="__codelineno-16-3" name="__codelineno-16-3" href="#__codelineno-16-3"></a><span class="p">}</span>
</span></code></pre></div>
<p>The names in the list of <code>packages</code> can be any of the following valid forms:</p>
<ul>
<li>A name of a package on PyPI: <code>"snowballstemmer"</code></li>
<li>A name for a package on PyPI with additional constraints:
  <code>"snowballstemmer&gt;=2.2.0"</code></li>
<li>An arbitrary URL to a Python package: <code>"https://.../package.whl"</code></li>
<li>A file copied onto the browser based file system: <code>"emfs://.../package.whl"</code></li>
</ul>
<h3 id="plugins">Plugins</h3>
<p>The <code>plugins</code> option lists plugins enabled by PyScript to add extra
functionality to the platform.</p>
<p>Each plugin should be included on the web page, as described in the
<a href="../plugins/">plugins</a> section. Then the plugin's name should be listed.</p>
<div class="language-TOML highlight"><span class="filename">A list of plugins in TOML</span><pre><span></span><code><span id="__span-17-1"><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a><span class="n">plugins</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;custom_plugin&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;!error&quot;</span><span class="p">]</span>
</span></code></pre></div>
<div class="language-JSON highlight"><span class="filename">A list of plugins in JSON</span><pre><span></span><code><span id="__span-18-1"><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a><span class="p">{</span>
</span><span id="__span-18-2"><a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a><span class="w">    </span><span class="nt">&quot;plugins&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;custom_plugin&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;!error&quot;</span><span class="p">]</span>
</span><span id="__span-18-3"><a id="__codelineno-18-3" name="__codelineno-18-3" href="#__codelineno-18-3"></a><span class="p">}</span>
</span></code></pre></div>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>The <code>"!error"</code> syntax is a way to turn off a plugin built into PyScript
that is enabled by default.</p>
<p>Currently, the only built-in plugin is the <code>error</code> plugin to display a
stack trace and error messages in the DOM. More may be added at a later
date.</p>
</div>
<h3 id="javascript-modules">JavaScript modules</h3>
<p>It's easy to import and use JavaScript modules in your Python code. This
section of the docs examines the configuration needed to make this work. How
to make use of JavaScript is dealt with <a href="../dom/#working-with-javascript">elsewhere</a>.</p>
<p>To do so, requires telling PyScript about the JavaScript modules you want to
use. This is the purpose of the <code>js_modules</code> related configuration fields.</p>
<p>There are two fields:</p>
<ul>
<li><code>js_modules.main</code> defines JavaScript modules loaded in the context of the
  main thread of the browser. Helpfully, it is also possible to interact with
  such modules <strong>from the context of workers</strong>. Sometimes such modules also
  need CSS files to work, and these can also be specified.</li>
<li><code>js_modules.worker</code> defines JavaScript modules loaded into the context of
  the web worker. Such modules <strong>must not expect</strong> <code>document</code> or <code>window</code>
  references (if this is the case,you must load them via <code>js_modules.main</code> and
  use them from the worker). However, if the JavaScript module could work
  without such references, then performance is better if defined on a worker.
  Because CSS is meaningless in the context of a worker, it is not possible to
  specify such files in a worker context.</li>
</ul>
<p>Once specified, your JavaScript modules will be available under the
<code>pyscript.js_modules.*</code> namespace.</p>
<p>To specify such modules, simply provide a list of source/module name pairs.</p>
<p>For example, to use the excellent <a href="https://leafletjs.com/">Leaflet</a> JavaScript
module for creating interactive maps you'd add the following lines:</p>
<div class="language-TOML highlight"><span class="filename">JavaScript main thread modules defined in TOML</span><pre><span></span><code><span id="__span-19-1"><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a><span class="k">[js_modules.main]</span>
</span><span id="__span-19-2"><a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a><span class="s2">&quot;https://cdn.jsdelivr.net/npm/leaflet@1.9.4/dist/leaflet-src.esm.js&quot;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;leaflet&quot;</span>
</span><span id="__span-19-3"><a id="__codelineno-19-3" name="__codelineno-19-3" href="#__codelineno-19-3"></a><span class="s2">&quot;https://cdn.jsdelivr.net/npm/leaflet@1.9.4/dist/leaflet.css&quot;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;leaflet&quot;</span><span class="w"> </span><span class="c1"># CSS</span>
</span></code></pre></div>
<div class="language-JSON highlight"><span class="filename">JavaScript main thread modules defined in JSON</span><pre><span></span><code><span id="__span-20-1"><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a><span class="p">{</span>
</span><span id="__span-20-2"><a id="__codelineno-20-2" name="__codelineno-20-2" href="#__codelineno-20-2"></a><span class="w">    </span><span class="nt">&quot;js_modules&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-20-3"><a id="__codelineno-20-3" name="__codelineno-20-3" href="#__codelineno-20-3"></a><span class="w">        </span><span class="nt">&quot;main&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-20-4"><a id="__codelineno-20-4" name="__codelineno-20-4" href="#__codelineno-20-4"></a><span class="w">            </span><span class="nt">&quot;https://cdn.jsdelivr.net/npm/leaflet@1.9.4/dist/leaflet-src.esm.js&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;leaflet&quot;</span><span class="p">,</span>
</span><span id="__span-20-5"><a id="__codelineno-20-5" name="__codelineno-20-5" href="#__codelineno-20-5"></a><span class="w">            </span><span class="nt">&quot;https://cdn.jsdelivr.net/npm/leaflet@1.9.4/dist/leaflet.css&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;leaflet&quot;</span>
</span><span id="__span-20-6"><a id="__codelineno-20-6" name="__codelineno-20-6" href="#__codelineno-20-6"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-20-7"><a id="__codelineno-20-7" name="__codelineno-20-7" href="#__codelineno-20-7"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-20-8"><a id="__codelineno-20-8" name="__codelineno-20-8" href="#__codelineno-20-8"></a><span class="p">}</span>
</span></code></pre></div>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>Notice how the second line references the required CSS needed for the
JavaScript module to work correctly.</p>
<p>The CSS file <strong>MUST</strong> target the very same name as the JavaScript module to
which it is related.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Since the Leaflet module expects to manipulate the DOM and have access to
<code>document</code> and <code>window</code> references, <strong>it must only be added via the
<code>js_modules.main</code> setting</strong> (as shown) and cannot be added in a worker
context.</p>
</div>
<p>At this point Python code running on either the main thread or in a
worker will have access to the JavaScript module like this:</p>
<div class="language-python highlight"><span class="filename">Making use of a JavaScript module from within Python.</span><pre><span></span><code><span id="__span-21-1"><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a><span class="kn">from</span> <span class="nn">pyscript.js_modules</span> <span class="kn">import</span> <span class="n">leaflet</span> <span class="k">as</span> <span class="n">L</span>
</span><span id="__span-21-2"><a id="__codelineno-21-2" name="__codelineno-21-2" href="#__codelineno-21-2"></a>
</span><span id="__span-21-3"><a id="__codelineno-21-3" name="__codelineno-21-3" href="#__codelineno-21-3"></a><span class="nb">map</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="s2">&quot;map&quot;</span><span class="p">)</span>
</span><span id="__span-21-4"><a id="__codelineno-21-4" name="__codelineno-21-4" href="#__codelineno-21-4"></a>
</span><span id="__span-21-5"><a id="__codelineno-21-5" name="__codelineno-21-5" href="#__codelineno-21-5"></a><span class="c1"># etc....</span>
</span></code></pre></div>
<p>Some JavaScript modules (such as
<a href="https://www.npmjs.com/package/html-escaper">html-escaper</a>) don't require
access to the DOM and, for efficiency reasons, can be included in the worker
context:</p>
<div class="language-TOML highlight"><span class="filename">A JavaScript worker module defined in TOML</span><pre><span></span><code><span id="__span-22-1"><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a><span class="k">[js_modules.worker]</span>
</span><span id="__span-22-2"><a id="__codelineno-22-2" name="__codelineno-22-2" href="#__codelineno-22-2"></a><span class="s2">&quot;https://cdn.jsdelivr.net/npm/html-escaper&quot;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;html_escaper&quot;</span>
</span></code></pre></div>
<div class="language-JSON highlight"><span class="filename">A JavaScript worker module defined in JSON</span><pre><span></span><code><span id="__span-23-1"><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a><span class="p">{</span>
</span><span id="__span-23-2"><a id="__codelineno-23-2" name="__codelineno-23-2" href="#__codelineno-23-2"></a><span class="w">    </span><span class="nt">&quot;js_modules&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-23-3"><a id="__codelineno-23-3" name="__codelineno-23-3" href="#__codelineno-23-3"></a><span class="w">        </span><span class="nt">&quot;worker&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-23-4"><a id="__codelineno-23-4" name="__codelineno-23-4" href="#__codelineno-23-4"></a><span class="w">            </span><span class="nt">&quot;https://cdn.jsdelivr.net/npm/html-escaper&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;html_escaper&quot;</span>
</span><span id="__span-23-5"><a id="__codelineno-23-5" name="__codelineno-23-5" href="#__codelineno-23-5"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-23-6"><a id="__codelineno-23-6" name="__codelineno-23-6" href="#__codelineno-23-6"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-23-7"><a id="__codelineno-23-7" name="__codelineno-23-7" href="#__codelineno-23-7"></a><span class="p">}</span>
</span></code></pre></div>
<p>However, <code>from polyscript.js_modules import html_escaper</code> would then only work
within the context of Python code <strong>running on a worker</strong>.</p>
<h3 id="custom">Custom</h3>
<p>Sometimes plugins or apps need bespoke configuration options.</p>
<p>So long as you don't cause a name collision with the built-in option names then
you are free to use any valid data structure that works with both TOML and JSON
to express your configuration needs.</p>
<p><strong>TODO: explain how to programmatically get access to an object representing
the config.</strong></p>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["content.code.copy", "content.code.annotate"], "search": "../../assets/javascripts/workers/search.dfff1995.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.dff1b7c8.min.js"></script>
      
    
  </body>
</html>